<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>


        <template id="sale_abbreviated_pdf">
            <t t-call="web.external_layout">
                <style>
                    .article .pt-5 { padding-top: 0px !important; }
                </style>
                <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)"/>
                <t t-set="forced_vat"
                   t-value="doc.fiscal_position_id.foreign_vat"/> <!-- So that it appears in the footer of the report instead of the company VAT if it's set -->
                <!--                <t t-set="address">-->
                <!--                    <div t-field="doc.partner_id"-->
                <!--                         t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />-->
                <!--                    <p t-if="doc.partner_id.vat">-->
                <!--                        <t t-esc="doc.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>-->
                <!--                        :-->
                <!--                        <span t-field="doc.partner_id.vat"/></p>-->
                <!--                </t>-->
                <!--                <t t-if="doc.partner_shipping_id == doc.partner_invoice_id-->
                <!--                             and doc.partner_invoice_id != doc.partner_id-->
                <!--                             or doc.partner_shipping_id != doc.partner_invoice_id">-->
                <!--                    <t t-set="information_block">-->
                <!--                        <strong t-if="doc.partner_shipping_id == doc.partner_invoice_id">Invoicing and Shipping Address:</strong>-->
                <!--                        <strong t-if="doc.partner_shipping_id != doc.partner_invoice_id">Invoicing Address:</strong>-->
                <!--                        <div t-field="doc.partner_invoice_id"-->
                <!--                             t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>-->
                <!--                        <t t-if="doc.partner_shipping_id != doc.partner_invoice_id">-->
                <!--                            <strong>Shipping Address:</strong>-->
                <!--                            <div t-field="doc.partner_shipping_id"-->
                <!--                                 t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>-->
                <!--                        </t>-->
                <!--                    </t>-->
                <!--                </t>-->
                <h6>
                    <strong>Customer Name:</strong>
                    <span t-field="doc.partner_id"/>
                </h6>
                <h6>
                    <strong>Project Name:</strong>
                    <span t-field="doc.customer_project_id"/>
                </h6>
                <div class="page">
                    <!--                    <div class="oe_structure"/>-->

                    <!--                    <h2 class="mt16">-->
                    <h2>
                        <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                            <span t-if="doc.state not in ['draft','sent']">Order #</span>
                            <span t-if="doc.state in ['draft','sent']">Quotation #</span>
                        </t>
                        <t t-if="env.context.get('proforma', False) or is_pro_forma">
                            <span>Pro-Forma Invoice #</span>
                        </t>
                        <span t-field="doc.name"/>
                    </h2>

                    <div class="row mt32 mb32" id="informations">
                        <div t-if="doc.client_order_ref" class="col-auto col-3 mw-100 mb-2">
                            <strong>Your Reference:</strong>
                            <p class="m-0" t-field="doc.client_order_ref"/>
                        </div>
                        <div t-if="doc.date_order and doc.state not in ['draft','sent']"
                             class="col-auto col-3 mw-100 mb-2">
                            <strong>Order Date:</strong>
                            <p class="m-0" t-field="doc.date_order"/>
                        </div>
                        <div t-if="doc.date_order and doc.state in ['draft','sent']" class="col-auto col-3 mw-100 mb-2">
                            <strong>Quotation Date:</strong>
                            <p class="m-0" t-field="doc.date_order" t-options='{"widget": "date"}'/>
                        </div>
                        <div t-if="doc.validity_date and doc.state in ['draft', 'sent']"
                             class="col-auto col-3 mw-100 mb-2" name="expiration_date">
                            <strong>Expiration:</strong>
                            <p class="m-0" t-field="doc.validity_date"/>
                        </div>
                        <div t-if="doc.user_id.name" class="col-auto col-3 mw-100 mb-2">
                            <strong>Salesperson:</strong>
                            <p class="m-0" t-field="doc.user_id"/>
                        </div>
                    </div>


                    <table class="table table-sm o_main_table">
                        <thead style="display: table-row-group">
                            <tr class="bg-200">
                                <th class="text-left">Category</th>
                                <th class="text-right">Total</th>
                                <th class="text-right">Discount Amount</th>
                                <th class="text-right">Untaxed Amount</th>
                                <th class="text-right">Tax Amount</th>
                                <th class="text-right">Taxed Amount</th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">
                            <!--
                                wood_order_line
                                bedroom_order_line
                                accessory_order_line
                                mixer_order_line
                                electronic_order_line
                                worktop_order_line
                                service_order_line
                                appliance_order_line
                                -->

                            <tr t-if="doc.wood_order_line" class="bg-100 font-weight-bold">
                                <td>Wood -
                                    <span t-field="doc.kitchen_type_id.name"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_untaxed"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_total"/>
                                </td>
                            </tr>
                            <tr t-if="doc.bedroom_order_line" class="bg-100 font-weight-bold">
                                <td>Bedrooms</td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.bedroom_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_total"/>
                                </td>
                            </tr>
                            <tr t-if="doc.accessory_order_line" class="bg-100 font-weight-bold">
                                <td>Accessories</td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_untaxed"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_total"/>
                                </td>
                            </tr>
                            <tr t-if="doc.mixer_order_line" class="bg-100 font-weight-bold">
                                <td>Sinks &amp; Mixers</td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.mixer_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_total"/>
                                </td>
                            </tr>
                            <tr t-if="doc.electronic_order_line" class="bg-100 font-weight-bold">
                                <td>Electromechanical Work</td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.electronic_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_total"/>
                                </td>
                            </tr>
                            <tr t-if="doc.worktop_order_line" class="bg-100 font-weight-bold">
                                <td>Worktops</td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.worktop_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_total"/>
                                </td>
                            </tr>

                            <tr t-if="doc.service_order_line" class="bg-100 font-weight-bold">
                                <td>Services</td>
                                <td class="text-right">
                                    <span t-field="doc.service_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.service_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.service_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.service_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.service_total"/>
                                </td>
                            </tr>

                            <tr t-if="doc.appliance_order_line" class="bg-100 font-weight-bold">
                                <td>Electric Hardware</td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_unit_prices"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.appliance_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_total"/>
                                </td>
                            </tr>

                            <t t-set="categ_lines"
                               t-value="doc.wood_order_line + doc.bedroom_order_line + doc.accessory_order_line + doc.mixer_order_line + doc.electronic_order_line + doc.worktop_order_line + doc.service_order_line + doc.appliance_order_line"/>
                            <t t-set="other_lines"
                               t-value="doc.order_line.filtered(lambda l: l.id not in categ_lines.ids)"/>
                            <t t-set="total_discount" t-value="sum(doc.order_line.mapped('discount'))"/>

                            <t t-set="other_untaxed" t-value="round(sum(other_lines.mapped('price_subtotal')), 2)"/>
                            <t t-set="other_tax" t-value="round(sum(other_lines.mapped('price_tax')), 2)"/>
                            <t t-set="other_total" t-value="round(other_untaxed + other_tax, 2)"/>
                            <t t-set="other_unit_prices"
                               t-value="round(sum(line.price_unit * line.product_uom_qty for line in other_lines)) ,2"/>


                            <tr t-if="other_lines" class="bg-100 font-weight-bold">
                                <td>Others</td>
                                <td class="text-right">
                                    <span t-esc="other_unit_prices"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.discount_amount_other"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="other_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-esc="other_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="other_total"/>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                    <!--                    <div class="row border col-6" style="float: right;">-->
                    <!--                        <div class="col-4">-->
                    <!--                            <strong>Total Discount</strong>-->
                    <!--                        </div>-->
                    <!--                        <div class="col-3 text-center">-->
                    <!--                            <strong t-esc="total_discount"/>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <!--                    <br/>-->
                    <!--                    <br/>-->
                    <div class="clearfix" name="so_total_summary">
                        <div id="total" class="row" name="total">
                            <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">
                                <table class="table table-sm">
                                    <!-- Tax totals -->
                                    <t t-call="account.document_tax_totals">
                                        <t t-set="tax_totals" t-value="doc.tax_totals"/>
                                        <t t-set="currency" t-value="doc.currency_id"/>
                                    </t>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div t-if="doc.signature" class="mt32 ml64 mr4" name="signature">
                        <div class="offset-8">
                            <strong>Signature</strong>
                        </div>
                        <div class="offset-8">
                            <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                        </div>
                        <div class="offset-8 text-center">
                            <p t-field="doc.signed_by"/>
                        </div>
                    </div>

                    <div class="oe_structure"/>

                    <p t-field="doc.note"/>
                    <p t-if="not is_html_empty(doc.payment_term_id.note)">
                        <span t-field="doc.payment_term_id.note"/>
                    </p>
                    <p id="fiscal_position_remark"
                       t-if="doc.fiscal_position_id and not is_html_empty(doc.fiscal_position_id.sudo().note)">
                        <strong>Fiscal Position Remark:</strong>
                        <span t-field="doc.fiscal_position_id.sudo().note"/>
                    </p>
                </div>
            </t>
        </template>


        <template id="report_sale_abbreviated">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hz_sale_custom.sale_abbreviated_pdf" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </template>


        <record id="action_report_sale_abbreviated" model="ir.actions.report">
            <field name="name">Abbreviated Price Quotation / Order</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">hz_sale_custom.report_sale_abbreviated</field>
            <field name="report_file">hz_sale_custom.report_sale_abbreviated</field>
            <field name="print_report_name">(object.state in ('draft', 'sent') and 'Abbreviated Price Quotation - %s' %
                (object.name)) or 'Abbreviated Price Order - %s' % (object.name)
            </field>
            <field name="binding_model_id" ref="sale.model_sale_order"/>
            <field name="binding_type">report</field>
        </record>
        <template id="sale_abbreviated_pdf_eg">
            <t t-call="web.external_layout">
                <style>
                    .article .pt-5 { padding-top: 0px !important; }
                </style>
                <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang,currency_id='egp')"/>
                <t t-set="forced_vat"
                   t-value="doc.fiscal_position_id.foreign_vat"/> <!-- So that it appears in the footer of the report instead of the company VAT if it's set -->
                <!--                <t t-set="address">-->
                <!--                    <div t-field="doc.partner_id"-->
                <!--                         t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />-->
                <!--                    <p t-if="doc.partner_id.vat">-->
                <!--                        <t t-esc="doc.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>-->
                <!--                        :-->
                <!--                        <span t-field="doc.partner_id.vat"/></p>-->
                <!--                </t>-->
                <!--                <t t-if="doc.partner_shipping_id == doc.partner_invoice_id-->
                <!--                             and doc.partner_invoice_id != doc.partner_id-->
                <!--                             or doc.partner_shipping_id != doc.partner_invoice_id">-->
                <!--                    <t t-set="information_block">-->
                <!--                        <strong t-if="doc.partner_shipping_id == doc.partner_invoice_id">Invoicing and Shipping Address:</strong>-->
                <!--                        <strong t-if="doc.partner_shipping_id != doc.partner_invoice_id">Invoicing Address:</strong>-->
                <!--                        <div t-field="doc.partner_invoice_id"-->
                <!--                             t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>-->
                <!--                        <t t-if="doc.partner_shipping_id != doc.partner_invoice_id">-->
                <!--                            <strong>Shipping Address:</strong>-->
                <!--                            <div t-field="doc.partner_shipping_id"-->
                <!--                                 t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>-->
                <!--                        </t>-->
                <!--                    </t>-->
                <!--                </t>-->
                <h6>
                    <strong>Customer Name:</strong>
                    <span t-field="doc.partner_id"/>
                </h6>
                <h6>
                    <strong>Project Name:</strong>
                    <span t-field="doc.customer_project_id"/>
                </h6>
                <div class="page">
                    <!--                    <div class="oe_structure"/>-->

                    <!--                    <h2 class="mt16">-->
                    <h2>
                        <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                            <span t-if="doc.state not in ['draft','sent']">Order #</span>
                            <span t-if="doc.state in ['draft','sent']">Quotation #</span>
                        </t>
                        <t t-if="env.context.get('proforma', False) or is_pro_forma">
                            <span>Pro-Forma Invoice #</span>
                        </t>
                        <span t-field="doc.name"/>
                    </h2>

                    <div class="row mt32 mb32" id="informations">
                        <div t-if="doc.client_order_ref" class="col-auto col-3 mw-100 mb-2">
                            <strong>Your Reference:</strong>
                            <p class="m-0" t-field="doc.client_order_ref"/>
                        </div>
                        <div t-if="doc.date_order and doc.state not in ['draft','sent']"
                             class="col-auto col-3 mw-100 mb-2">
                            <strong>Order Date:</strong>
                            <p class="m-0" t-field="doc.date_order"/>
                        </div>
                        <div t-if="doc.date_order and doc.state in ['draft','sent']" class="col-auto col-3 mw-100 mb-2">
                            <strong>Quotation Date:</strong>
                            <p class="m-0" t-field="doc.date_order" t-options='{"widget": "date"}'/>
                        </div>
                        <div t-if="doc.validity_date and doc.state in ['draft', 'sent']"
                             class="col-auto col-3 mw-100 mb-2" name="expiration_date">
                            <strong>Expiration:</strong>
                            <p class="m-0" t-field="doc.validity_date"/>
                        </div>
                        <div t-if="doc.user_id.name" class="col-auto col-3 mw-100 mb-2">
                            <strong>Salesperson:</strong>
                            <p class="m-0" t-field="doc.user_id"/>
                        </div>
                    </div>


                    <table class="table table-sm o_main_table">
                        <thead style="display: table-row-group">
                            <tr class="bg-200">
                                <th class="text-left">Category</th>
                                <th class="text-right">Total</th>
                                <th class="text-right">
                                    Discount Amount
                                </th>
                                <th class="text-right">Untaxed Amount</th>

                                <th class="text-right">Tax Amount</th>
                                <th class="text-right">Taxed Amount</th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">
                            <!--
                                wood_order_line
                                bedroom_order_line
                                accessory_order_line
                                mixer_order_line
                                electronic_order_line
                                worktop_order_line
                                service_order_line
                                appliance_order_line
                                -->

                            <tr t-if="doc.wood_order_line" class="bg-100 font-weight-bold">
                                <td>Wood -
                                    <span t-field="doc.kitchen_type_id.name"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_discount_amount_egp"
                                          t-options='{"widget": "float", "precision": 2}'/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_untaxed_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.wood_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.wood_total_egp"/>
                                </td>
                            </tr>
                            <tr t-if="doc.bedroom_order_line" class="bg-100 font-weight-bold">
                                <td>Bedrooms</td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_untaxed_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.bedroom_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.bedroom_total_egp"/>
                                </td>
                            </tr>
                            <tr t-if="doc.accessory_order_line" class="bg-100 font-weight-bold">
                                <td>Accessories</td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_untaxed_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.accessory_total_egp"/>
                                </td>
                            </tr>
                            <tr t-if="doc.mixer_order_line" class="bg-100 font-weight-bold">
                                <td>Sinks &amp; Mixers</td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_untaxed_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.mixer_total_egp"/>
                                </td>
                            </tr>
                            <tr t-if="doc.electronic_order_line" class="bg-100 font-weight-bold">
                                <td>Electromechanical Work</td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_untaxed_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.electronic_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.electronic_total_egp"/>
                                </td>
                            </tr>
                            <tr t-if="doc.worktop_order_line" class="bg-100 font-weight-bold">
                                <td>Worktops</td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_untaxed_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.worktop_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.worktop_total_egp"/>
                                </td>
                            </tr>

                            <tr t-if="doc.service_order_line" class="bg-100 font-weight-bold">
                                <td>Services</td>
                                <td class="text-right">
                                    <span t-field="doc.service_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.service_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.service_untaxed_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.service_tax_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.service_total_egp"/>
                                </td>
                            </tr>

                            <tr t-if="doc.appliance_order_line" class="bg-100 font-weight-bold">
                                <td class="text-right">
                                    <span t-field="doc.appliance_unit_prices_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_discount_amount_egp"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_untaxed_egp"/>
                                </td>

                                <td class="text-right">
                                    <span t-field="doc.appliance_tax_egp"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="doc.appliance_total_egp"/>
                                </td>
                            </tr>

                            <t t-set="categ_lines"
                               t-value="doc.wood_order_line + doc.bedroom_order_line + doc.accessory_order_line + doc.mixer_order_line + doc.electronic_order_line + doc.worktop_order_line + doc.service_order_line + doc.appliance_order_line"/>
                            <t t-set="other_lines"
                               t-value="doc.order_line.filtered(lambda l: l.id not in categ_lines.ids)"/>
                            <!--                            <t t-set="total_discount" t-value="sum(doc.order_line.mapped('discount'))"/>-->

                            <t t-set="other_untaxed" t-value="round(sum(other_lines.mapped('price_subtotal_egp')), 2)"/>
                            <t t-set="other_tax" t-value="round(sum(other_lines.mapped('price_tax_egp') or [0.0]), 2)"/>
                            <t t-set="other_total" t-value="round(other_untaxed + other_tax, 2)"/>
                            <t t-set="other_unit_prices_egp"
                               t-value="round(sum(other_lines.mapped(lambda l: l.price_unit_egp * l.product_uom_qty) or [0.0]), 2)"/>
                            <tr t-if="other_lines" class="bg-100 font-weight-bold">
                                <td>Others</td>
                                <td class="text-right">
                                    <span t-esc="other_unit_prices_egp"/>

                                </td>
                                <td class="text-right">
                                    <span t-field="doc.discount_amount"
                                          t-options="{'widget': 'float', 'precision': 2}"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="other_untaxed"/>
                                </td>

                                <td class="text-right">
                                    <span t-esc="other_tax"/>
                                </td>
                                <td class="text-right">
                                    <span t-esc="other_total"/>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                    <t t-if="doc.show_discount">
                        <div class="row">
                            <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">
                                <!--                            <div class="col-4">-->
                                <!--                                <strong>Total Amount</strong>-->
                                <!--                                <br/>-->
                                <!--                                <strong>Total Discount</strong>-->
                                <!--                            </div>-->
                                <!--                            <div class="col-4 text-center" style="margin-left: 130px;">-->
                                <!--                                <strong t-field="doc.amount_undiscounted_eg" t-options='{"widget": "float", "precision": 2}'/>-->
                                <!--                                <br/>-->
                                <!--                                <strong t-field="doc.discount_amount"/>-->
                                <!--                            </div>-->
                                <table class="table table-sm">
                                    <tr>
                                        <td style="border: 2px solid black;">Total Amount</td>
                                        <td class="text-right" style="border: 2px solid black;">
                                            <strong t-field="doc.amount_undiscounted_eg"
                                                    t-options='{"widget": "float", "precision": 2}'/>
                                            <!--                                            <span t-field="doc.amount_undiscounted_egp" t-options='{"widget": "float", "precision": 2}'/>-->
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border: 2px solid black; background:#FFF;color:#000">Total Discount
                                        </td>
                                        <td class="text-right"
                                            style="border: 2px solid black; background:#FFF;color:#000">
                                            <strong t-field="doc.discount_amount"/>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </t>
                    <div class="clearfix" name="so_total_summary">
                        <div id="total" class="row" name="total">
                            <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">
                                <table class="table table-sm">
                                    <table class="table table-sm">
                                        <!-- Tax totals -->
                                        <t t-call="account.document_tax_totals">
                                            <t t-set="tax_totals" t-value="doc.tax_totals_egp"/>
                                            <t t-set="currency" t-value="doc.company_id.currency_id"/>
                                        </t>
                                    </table>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div t-if="doc.signature" class="mt32 ml64 mr4" name="signature">
                        <div class="offset-8">
                            <strong>Signature</strong>
                        </div>
                        <div class="offset-8">
                            <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                        </div>
                        <div class="offset-8 text-center">
                            <p t-field="doc.signed_by"/>
                        </div>
                    </div>

                    <div class="oe_structure"/>

                    <p t-field="doc.note"/>
                    <p t-if="not is_html_empty(doc.payment_term_id.note)">
                        <span t-field="doc.payment_term_id.note"/>
                    </p>
                    <p id="fiscal_position_remark"
                       t-if="doc.fiscal_position_id and not is_html_empty(doc.fiscal_position_id.sudo().note)">
                        <strong>Fiscal Position Remark:</strong>
                        <span t-field="doc.fiscal_position_id.sudo().note"/>
                    </p>
                </div>
            </t>
        </template>

        <template id="report_sale_abbreviated_eg">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="hz_sale_custom.sale_abbreviated_pdf_eg" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </template>
        <record id="action_report_sale_abbreviated_eg" model="ir.actions.report">
            <field name="name">Abbreviated Price Quotation / Order (EG)</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">hz_sale_custom.report_sale_abbreviated_eg</field>
            <field name="report_file">hz_sale_custom.report_sale_abbreviated_eg</field>
            <field name="print_report_name">(object.state in ('draft', 'sent') and 'Abbreviated Price Quotation - %s' %
                (object.name)) or 'Abbreviated Price Order - %s' % (object.name)
            </field>
            <field name="binding_model_id" ref="sale.model_sale_order"/>
            <field name="binding_type">report</field>
        </record>

    </data>
</odoo>
